# sthInvokeUsingCulture

**sthInvokeUsingCulture** - это модуль, содержащий четыре функции, предназначенные для выполнения команд с указанными региональными настройками.

В модуль входят следующие функции:

[**Enter-sthCulture**](#enter-sthculture) - Функция входит в 'область' указанных региональных настроек.

[**Invoke-sthUsingCulture**](#invoke-sthusingculture) - Функция выполняет команды с использованием указанных региональных настроек.

[**Set-sthCulture**](#set-sthculture) - Функция задает указанные региональные настройки для текущей сессии.

[**Reset-sthCulture**](#reset-sthculture) - Функция возвращает региональные настройки для текущей сессии к изначальному значению.

## Как его установить?

Вы можете установить модуль sthInvokeUsingCulture из PowerShell Gallery:

```
Install-Module sthInvokeUsingCulture
```

## Как с этим работать?

### Enter-sthCulture

#### Пример 1: Вход в область указанных региональных настроек

Команды входят в область указанных региональных настроек и выполняют определенную инструкцию.\
Первая команда входит в область региональных настроек de-DE.\
Вторая команда использует оператор -f для форматирования значения.\
Третья команда выходит из области de-DE.

```
PS C:\> Enter-sthCulture -Culture de-DE

[de-DE] PS C:\>> "{0:n}" -f 1234567890

1.234.567.890,00

[de-DE] PS C:\>> exit

PS C:\>
```

### Invoke-sthUsingCulture

#### Пример 1: Выполнение команды с использованием указанных региональных настроек

Команда выполняет скрипт-блок с использованием региональных настроек de-DE.

```
Invoke-sthUsingCulture -Culture de-DE -ScriptBlock {"{0:n}" -f 1234567890}

1.234.567.890,00
```

---

#### Пример 2: Выполнение команды Get-Help с использованием указанных региональных настроек

Команда выполняет командлет Get-Help для функции Enter-sthCulture с использованием региональных настроек ru-RU.

```
Invoke-sthUsingCulture -Culture ru-ru -ScriptBlock { Get-Help Enter-sthCulture }

NAME
    Enter-sthCulture

SYNOPSIS
    Входит в 'область' указанных региональных настроек.
...
```

Если ранее вы уже использовали команду Get-Help для функции с использованием региональных настроек по умолчанию и теперь вышеприведенная команда возвращает результат в соответствии с этими настройками по умолчанию вместо указанных, просто реимпортируйте модуль в который входит функция, для которой вы получаете справочную информацию, например, так: Import-Module sthInvokeUsingCulture и вызовите команду еще раз.

### Set-sthCulture

#### Пример 1: Изменение текущих региональных настроек

Первая команда изменяет текущие региональные настройки на de-DE.\
Вторая команда использует оператор -f для форматирования значения.

```
Set-sthCulture -Culture de-DE

"{0:n}" -f 1234567890

1.234.567.890,00
```

### Reset-sthCulture

#### Пример 1: Возвращение региональных настроек к изначальному значению

Первая команда получает текущие региональные настройки. Сейчас это en-US.\
Вторая команда изменяет их на fr-FR для текущей сессии.\
Третья команда получает текущие региональные настройки. Сейчас это fr-FR.\
Четвертая команда возвращает их к первоначальному значению.\
Пятая команда получает текущие региональные настройки. Сейчас это снова en-US.

```
Get-Culture

LCID             Name             DisplayName
----             ----             -----------
1033             en-US            English (United States)

Set-sthCulture -Culture fr-FR

Get-Culture

LCID             Name             DisplayName
----             ----             -----------
1036             fr-FR            French (France)

Reset-sthCulture

Get-Culture

LCID             Name             DisplayName
----             ----             -----------
1033             en-US            English (United States)
```
